---
id: be09cfc5-de99-4f91-8f98-b4a6f4461b46
title: Newsflash! ASP.NET Web API does not Sit on Top of ASP.NET MVC! In Fact, It
  does not Sit on Top of Anything
abstract: One of the common misconceptions about ASP.NET Web API is that it is being
  built on top of ASP.NET MVC. Today, I am going to break it!
created_at: 2012-10-20 08:57:00 +0000 UTC
tags:
- .net
- ASP.Net
- ASP.NET MVC
- ASP.NET Web API
slugs:
- newsflash-asp-net-web-api-does-not-sit-on-top-of-asp-net-mvc-in-fact-it-does-not-sit-on-top-of-anything
---

<p>One of the common misconceptions about <a href="http://www.asp.net/web-api">ASP.NET Web API</a> is that it is being built on top of <a href="http://www.asp.net/mvc">ASP.NET MVC</a>&nbsp;(particularly ASP.NET MVC 4). In my opinion, the distribution of ASP.NET Web API along with ASP.NET MVC installer has the biggest effect on this misconception. The other effect might be that the programming models in both frameworks are very similar. In fact, you will find some classes with the same name in both frameworks.</p>
<h3>Here is the Deal</h3>
<p>Sorry folks but I am going to break the news for you: <strong>ASP.NET Web API doesn&rsquo;t sit on top of ASP.NET MVC.</strong> To be more accurate, ASP.NET Web API doesn&rsquo;t sit on top of anything other than .NET. You can make it sit pretty much on top of wherever the hell you want for it to sit. This is the concept which makes it so darn easy to self-host ASP.NET Web API. The team made this awesome framework sit on top of ASP.NET and WCF by providing two hosting options right out of the box.</p>
<p>Let's make something more clrear because I don't wanna give the wrong impression here. ASP.NET MVC and ASP.NET Web API runs perfectly side by side. It's just that ASP.NET Web API has nothing to do with ASP.NET MVC.</p>
<p>Ok, you wouldn't want to believe a random dude on the internet, would you? Let&rsquo;s dig a little deeper to see whether I am fabricating here or not.</p>
<h3>Prove it!</h3>
<p>Let&rsquo;s open up the <a href="http://aspnetwebstack.codeplex.com">ASP.NET Web Stack</a> source code in Visual studio and have a look at the reference list of System.Web.Http project:</p>
<p><a href="https://www.tugberkugurlu.com/Content/images/Uploadedbyauthors/wlw/Newsflash-ASP.NET-Web-API-does-n.NET-MVC_BF26/10-20-2012-2-24-47-PM.png"><img title="10-20-2012 2-24-47 PM" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" border="0" alt="10-20-2012 2-24-47 PM" src="https://www.tugberkugurlu.com/Content/images/Uploadedbyauthors/wlw/Newsflash-ASP.NET-Web-API-does-n.NET-MVC_BF26/10-20-2012-2-24-47-PM_thumb.png" width="417" height="484" /></a></p>
<p>System.Web.Http.dll is the core assembly which holds the logic and everything related to ASP.NET Web API. When you look at the References tab in the above picture, can you see any System.Web.Mvc reference there? No (unless you are hallucinating)! Actually, take a closer look again. Can you now even see any System.Web reference there? No (unless you are hallucinating)! This is because the fact that ASP.NET Web API core infrastructure has been decoupled from the hosting layer.</p>
<p>The below picture shows the assembly references of the ASP.NET hosting project for Web API:</p>
<p><a href="https://www.tugberkugurlu.com/Content/images/Uploadedbyauthors/wlw/Newsflash-ASP.NET-Web-API-does-n.NET-MVC_BF26/10-20-2012-2-07-18-PM.png"><img title="10-20-2012 2-07-18 PM" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" border="0" alt="10-20-2012 2-07-18 PM" src="https://www.tugberkugurlu.com/Content/images/Uploadedbyauthors/wlw/Newsflash-ASP.NET-Web-API-does-n.NET-MVC_BF26/10-20-2012-2-07-18-PM_thumb.png" width="392" height="484" /></a></p>
<p>You can see that System.Web is now referenced here, but can you see any System.Web.Mvc reference here? No (unless you are hallucinating)! So, I am very curious here about where they have gotten the idea that ASP.NET Web API runs on top of ASP.NET MVC because it simply does not!</p>
<p>Let&rsquo;s now dig a little deeper to see how ASP.NET hosting has been implemented and this will give us a better understanding. ASP.NET Web API plays by the rules and registers itself into the ASP.NET pipeline just like ASP.NET MVC does: with <a href="http://msdn.microsoft.com/en-us/library/system.web.routing.iroutehandler.aspx">IRouteHandler</a> and <a href="http://msdn.microsoft.com/en-us/library/system.web.ihttphandler.aspx">IHttpHandler</a> (actually <a href="http://msdn.microsoft.com/en-us/library/system.web.ihttpasynchandler.aspx">IHttpAsyncHandler</a>) implementations:</p>
<p><a href="https://www.tugberkugurlu.com/Content/images/Uploadedbyauthors/wlw/Newsflash-ASP.NET-Web-API-does-n.NET-MVC_BF26/10-20-2012-2-13-07-PM.png"><img title="10-20-2012 2-13-07 PM" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" border="0" alt="10-20-2012 2-13-07 PM" src="https://www.tugberkugurlu.com/Content/images/Uploadedbyauthors/wlw/Newsflash-ASP.NET-Web-API-does-n.NET-MVC_BF26/10-20-2012-2-13-07-PM_thumb.png" width="644" height="345" /></a></p>
<p>In my personal opinion, the ASP.NET Web API has been designed so beautifully. All the stuff that the hosting layer needs to do is to construct a new <a href="http://msdn.microsoft.com/en-us/library/system.web.http.httpconfiguration.aspx">HttpConfiguration</a> object and pass that configuration on to <a href="http://msdn.microsoft.com/en-us/library/system.web.http.HttpServer.aspx">HttpServer</a> instance and BOM! You can then invoke that HttpServer instance with <a href="http://msdn.microsoft.com/en-us/library/system.net.http.httpmessageinvoker.aspx">HttpMessageInvoker</a> (or anything else which will do the job) and you are now inside the ASP.NET Web API pipeline. This is what <a href="http://msdn.microsoft.com/en-us/library/system.web.http.webhost.httpcontrollerhandler(v=vs.108).aspx">HttpControllerHandler</a> is actually doing in an ASP.NET hosting scenario. It gets the <a href="http://msdn.microsoft.com/en-us/library/system.web.httpcontextbase.aspx">HttpContextBase</a> and converts it into an HttpRequestMessage instance. Later, it uses that newly created <a href="http://msdn.microsoft.com/en-us/library/system.net.http.httprequestmessage.aspx">HttpRequestMessage</a> to invoke the SendAsync method of the HttpMessageInvoker.</p>
<p>This type of design also allows us to write beautiful and easy integration tests against our ASP.NET Web API application. You can find more information about <a href="http://www.strathweb.com/2012/06/asp-net-web-api-integration-testing-with-in-memory-hosting/">ASP.NET Web API integration testing on Filip&rsquo;s blog post</a>.</p>
<p>I am now hoping that this will give you a better idea how ASP.NET Web API has been structured and where it really sits on <img class="wlEmoticon wlEmoticon-smile" style="border-style: none;" alt="Smile" src="https://www.tugberkugurlu.com/Content/images/Uploadedbyauthors/wlw/Newsflash-ASP.NET-Web-API-does-n.NET-MVC_BF26/wlEmoticon-smile.png" /></p>